# Bytecode Compiler

This repository contains an implementation of a bytecode compiler and virtual machine, It translates source code into bytecode, which is then executed by the virtual machine.

## Table of Contents

- [Introduction](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
- [Features](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
- [Project Structure](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
- [Usage](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
- [Detailed Components](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
    - [Token](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
    - [Lexer](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
    - [Parser](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
    - [AST](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
    - [Evaluator](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
    - [Object System](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
    - [Compiler](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
    - [Code](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
    - [Virtual Machine](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
- [REPL](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)
- [Future Improvements](https://www.notion.so/Notes-eb20ab6b38d64ab79e8daff3e2dff9d9?pvs=21)

## Introduction

This project implements a bytecode compiler and virtual machine for the Monkey programming language. It features a lexer, parser, abstract syntax tree (AST) construction, and a compiler that generates bytecode. The bytecode is then executed by a virtual machine.

## Features

- Lexical analysis to tokenize the input source code.
- Parsing tokens to generate an abstract syntax tree (AST).
- Compilation of the AST into bytecode.
- Execution of bytecode using a stack-based virtual machine.
- Builtin functions for common operations.
- Interactive Read-Eval-Print Loop (REPL) for executing Monkey code interactively.

## Project Structure

```
monkey/
├── ast/
│   └── ast.go
├── compiler/
│   ├── compiler.go
│   ├── symbol_table.go
├── evaluator/
│   ├── evaluator.go
│   ├── builtins.go
├── lexer/
│   └── lexer.go
├── object/
│   ├── object.go
│   ├── builtins.go
│   ├── environment.go
├── parser/
│   ├── parser.go
│   ├── parser_tracing.go
├── repl/
│   └── repl.go
├── token/
│   └── token.go
├── vm/
│   ├── vm.go
│   ├── frame.go
└── code/
    └── code.go

```

## Usage

To run the REPL, use the following command:

```
go run main.go

```

This will start an interactive prompt where you can type and execute Monkey code.

## Detailed Components

### Token

The `token` package defines the tokens used by the lexer and parser. Each token represents a distinct element of the Monkey language syntax.

### Lexer

The `lexer` package is responsible for lexical analysis. It reads the input source code and converts it into a series of tokens.

### Parser

The `parser` package constructs an Abstract Syntax Tree (AST) from the tokens provided by the lexer. It validates the syntax and structure of the input code.

### AST

The `ast` package defines the structures used to represent the AST. This tree structure is used by the compiler and evaluator to represent the parsed code.

### Evaluator

The `evaluator` package directly evaluates the AST. It includes support for builtin functions and allows for immediate execution of code without compiling to bytecode.

### Object System

The `object` package defines the various data types and objects used within the Monkey language, including the environment and builtin functions.

### Compiler

The `compiler` package converts the AST into bytecode. It manages the symbol table, handles scope resolution, and generates the bytecode instructions.

### Code

The `code` package defines the bytecode instructions and their encoding. It includes utilities for working with bytecode.

### Virtual Machine

The `vm` package implements a stack-based virtual machine that executes the bytecode generated by the compiler. It maintains the state of the execution and manages the stack and heap.

## REPL

The `repl` package provides an interactive Read-Eval-Print Loop for the Monkey language. It continuously reads input, compiles and executes it, and prints the results.

To start the REPL:

```go
package main

import (
	"fmt"
	"monkey/repl"
	"os"
)

func main() {
	fmt.Println("Welcome to the Monkey programming language!")
	fmt.Println("Feel free to type in commands")
	repl.Start(os.Stdin, os.Stdout)
}

```

## Future Improvements

- **Advanced Optimizations:** Implement advanced optimization techniques in the compiler to improve the performance of generated bytecode.
- **Garbage Collection:** Introduce a garbage collection mechanism to manage memory more efficiently.
- **Standard Library:** Expand the set of builtin functions and create a standard library for common utilities.
- **Debugging Tools:** Add debugging tools and better error messages to assist in the development and debugging of Monkey programs.
- **Extensive Testing:** Improve the test coverage to ensure the reliability and stability of the compiler and virtual machine.
